<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>썬데이허그 관리 시스템</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Supabase JS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- 헤더 -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1>🏪 썬데이허그 관리 시스템</h1>
                <div class="header-actions">
                    <button id="refreshBtn" class="btn btn-secondary">
                        <span class="icon">🔄</span>
                        새로고침
                    </button>
                    <button id="syncBtn" class="btn btn-primary">
                        <span class="icon">📦</span>
                        <span id="syncBtnText">재고 동기화</span>
                    </button>
                </div>
            </div>
            
            <!-- 탭 네비게이션 -->
            <nav class="tabs">
                <button class="tab-btn active" data-tab="inventory">
                    📦 재고 관리
                </button>
                <button class="tab-btn" data-tab="orders">
                    🛒 주문 관리
                </button>
            </nav>
            
            <div id="lastSyncInfo" class="last-sync">
                마지막 동기화: <span id="lastSyncTime">-</span>
            </div>
        </div>
    </header>

    <!-- 메인 컨텐츠 -->
    <main class="main">
        <div class="container">
            <!-- 재고 관리 탭 -->
            <div id="inventoryTab" class="tab-content active">
            <!-- 통계 카드 -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">📊</div>
                    <div class="stat-content">
                        <div class="stat-label">총 제품 수</div>
                        <div class="stat-value" id="totalProducts">-</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">✅</div>
                    <div class="stat-content">
                        <div class="stat-label">정상 재고</div>
                        <div class="stat-value" id="normalStock">-</div>
                    </div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-icon">⚠️</div>
                    <div class="stat-content">
                        <div class="stat-label">재고 부족</div>
                        <div class="stat-value" id="lowStock">-</div>
                    </div>
                </div>
                <div class="stat-card danger">
                    <div class="stat-icon">🚨</div>
                    <div class="stat-content">
                        <div class="stat-label">품절</div>
                        <div class="stat-value" id="outOfStock">-</div>
                    </div>
                </div>
            </div>

            <!-- 재고 테이블 -->
            <div class="table-container">
                <div class="table-header">
                    <h2>📦 재고 현황</h2>
                    <div class="table-filters">
                        <select id="statusFilter" class="filter-select">
                            <option value="all">전체 상태</option>
                            <option value="정상">정상</option>
                            <option value="재고부족">재고부족</option>
                            <option value="품절">품절</option>
                        </select>
                        <input 
                            type="text" 
                            id="searchInput" 
                            class="search-input" 
                            placeholder="SKU 또는 제품명 검색..."
                        >
                    </div>
                </div>

                <div id="loadingState" class="loading">
                    <div class="spinner"></div>
                    <p>데이터를 불러오는 중...</p>
                </div>

                <div id="errorState" class="error-state" style="display: none;">
                    <div class="error-icon">❌</div>
                    <p id="errorMessage">데이터를 불러오는 중 오류가 발생했습니다</p>
                    <button onclick="loadInventory()" class="btn btn-secondary">다시 시도</button>
                </div>

                <div id="emptyState" class="empty-state" style="display: none;">
                    <div class="empty-icon">📭</div>
                    <p>재고 데이터가 없습니다</p>
                    <button id="syncBtnEmpty" class="btn btn-primary">첫 동기화 시작하기</button>
                </div>

                <div id="tableWrapper" style="display: none;">
                    <table class="inventory-table">
                        <thead>
                            <tr>
                                <th>상태</th>
                                <th>SKU</th>
                                <th>제품명</th>
                                <th>현재 재고</th>
                                <th>변동량</th>
                                <th>알림 기준</th>
                                <th>마지막 업데이트</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryTableBody">
                            <!-- 동적으로 생성됨 -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 동기화 로그 -->
            <div class="logs-container">
                <div class="logs-header">
                    <h2>📋 동기화 기록</h2>
                    <button id="toggleLogs" class="btn btn-text">
                        <span id="toggleIcon">▼</span>
                        펼치기/접기
                    </button>
                </div>
                <div id="logsContent" class="logs-content" style="display: none;">
                    <div id="logsTableWrapper">
                        <table class="logs-table">
                            <thead>
                                <tr>
                                    <th>시각</th>
                                    <th>유형</th>
                                    <th>상태</th>
                                    <th>성공</th>
                                    <th>실패</th>
                                    <th>소요시간</th>
                                </tr>
                            </thead>
                            <tbody id="logsTableBody">
                                <!-- 동적으로 생성됨 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            </div>
            <!-- 재고 관리 탭 끝 -->

            <!-- 주문 관리 탭 -->
            <div id="ordersTab" class="tab-content">
                <!-- 주문 통계 카드 -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">🛒</div>
                        <div class="stat-content">
                            <div class="stat-label">총 주문 수</div>
                            <div class="stat-value" id="totalOrders">-</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">📦</div>
                        <div class="stat-content">
                            <div class="stat-label">배송중</div>
                            <div class="stat-value" id="shippingOrders">-</div>
                        </div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">⏳</div>
                        <div class="stat-content">
                            <div class="stat-label">신규주문</div>
                            <div class="stat-value" id="newOrders">-</div>
                        </div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">✅</div>
                        <div class="stat-content">
                            <div class="stat-label">배송완료</div>
                            <div class="stat-value" id="completedOrders">-</div>
                        </div>
                    </div>
                </div>

                <!-- 주문 테이블 -->
                <div class="table-container">
                    <div class="table-header">
                        <div>
                            <h2>🛒 주문 현황</h2>
                            <p style="font-size: 0.875rem; color: #6b7280; margin-top: 0.25rem;">
                                📌 필터 설정 후 "주문 동기화" 버튼을 누르면 해당 조건으로 PlayAuto에서 데이터를 가져옵니다
                            </p>
                        </div>
                        <div class="table-filters">
                            <input 
                                type="date" 
                                id="startDateFilter" 
                                class="filter-input"
                            >
                            <span>~</span>
                            <input 
                                type="date" 
                                id="endDateFilter" 
                                class="filter-input"
                            >
                            <select id="shopFilter" class="filter-select">
                                <option value="all">전체 쇼핑몰</option>
                                <option value="A077">스마트스토어</option>
                                <option value="B616">카페24</option>
                            </select>
                            <select id="orderStatusFilter" class="filter-select">
                                <option value="all">전체 상태</option>
                                <option value="신규주문">신규주문</option>
                                <option value="배송중">배송중</option>
                                <option value="배송완료">배송완료</option>
                            </select>
                            <input 
                                type="text" 
                                id="orderSearchInput" 
                                class="search-input" 
                                placeholder="주문번호 또는 고객명 검색..."
                            >
                        </div>
                    </div>

                    <div id="ordersLoadingState" class="loading">
                        <div class="spinner"></div>
                        <p>주문 데이터를 불러오는 중...</p>
                    </div>

                    <div id="ordersErrorState" class="error-state" style="display: none;">
                        <div class="error-icon">❌</div>
                        <p id="ordersErrorMessage">주문 데이터를 불러오는 중 오류가 발생했습니다</p>
                        <button onclick="loadOrders()" class="btn btn-secondary">다시 시도</button>
                    </div>

                    <div id="ordersEmptyState" class="empty-state" style="display: none;">
                        <div class="empty-icon">📭</div>
                        <p>주문 데이터가 없습니다</p>
                        <button id="syncOrdersBtnEmpty" class="btn btn-primary">첫 동기화 시작하기</button>
                    </div>

                    <div id="ordersTableWrapper" style="display: none;">
                        <table class="inventory-table">
                            <thead>
                                <tr>
                                    <th>상태</th>
                                    <th>주문번호</th>
                                    <th>쇼핑몰</th>
                                    <th>주문일시</th>
                                    <th>고객명</th>
                                    <th>상품명</th>
                                    <th>SKU</th>
                                    <th>수량</th>
                                    <th>금액</th>
                                    <th>배송사</th>
                                    <th>송장번호</th>
                                </tr>
                            </thead>
                            <tbody id="ordersTableBody">
                                <!-- 동적으로 생성됨 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 주문 동기화 로그 -->
                <div class="logs-container">
                    <div class="logs-header">
                        <h2>📋 주문 동기화 기록</h2>
                        <button id="toggleOrdersLogs" class="btn btn-text">
                            <span id="toggleOrdersIcon">▼</span>
                            펼치기/접기
                        </button>
                    </div>
                    <div id="ordersLogsContent" class="logs-content" style="display: none;">
                        <div id="ordersLogsTableWrapper">
                            <table class="logs-table">
                                <thead>
                                    <tr>
                                        <th>시각</th>
                                        <th>유형</th>
                                        <th>상태</th>
                                        <th>성공</th>
                                        <th>실패</th>
                                        <th>소요시간</th>
                                        <th>출처</th>
                                    </tr>
                                </thead>
                                <tbody id="ordersLogsTableBody">
                                    <!-- 동적으로 생성됨 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 주문 관리 탭 끝 -->
        </div>
    </main>

    <!-- 토스트 알림 -->
    <div id="toast" class="toast"></div>

    <!-- 로딩 오버레이 -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="spinner-large"></div>
            <p id="loadingMessage">재고 동기화 중...</p>
            <p id="loadingSubtext" style="font-size: 0.875rem; color: rgba(255,255,255,0.8); margin-top: 0.5rem;">
                잠시만 기다려주세요...
            </p>
        </div>
    </div>

    <!-- Config 파일 -->
    <script src="config.js"></script>
    <!-- Main App -->
    <script src="app.js"></script>
</body>
</html>


