# 개발 일지 - 2026년 1월 6일

## 주요 작업 내용

### Customer 앱 다국어(i18n) 글로벌화 기반 구축

고객용 앱(customer)의 글로벌 진출을 위한 다국어 시스템 기반을 구축했습니다.

---

## 1. DB 마이그레이션

### 신규 테이블 (supabase/migrations/016_add_i18n_tables.sql)

| 테이블 | 설명 |
|--------|------|
| `supported_languages` | 지원 언어 목록 (ko, en, ja, vi, zh-TW, zh-CN, ar) |
| `countries` | 국가 정보 (KR, JP, VN, TW, CN, SA, US, GB) |
| `country_feature_flags` | 국가별 기능 플래그 |

### 지원 언어 (7개)
- 한국어 (ko) - 기본
- English (en)
- 日本語 (ja)
- Tiếng Việt (vi)
- 繁體中文 (zh-TW)
- 简体中文 (zh-CN)
- العربية (ar) - RTL 지원

---

## 2. i18n 인프라 구축

### 구현 파일
- `apps/customer/app/i18n.ts` - i18next 설정 (언어, RTL, 네임스페이스)
- `apps/customer/app/core/lib/i18next.server.ts` - 서버 사이드 번역 로더
- `apps/customer/app/core/hooks/use-country-features.ts` - 국가별 기능 플래그 훅
- `apps/customer/app/locales/` - 번역 파일 디렉토리

### 번역 네임스페이스 구조 (8개)
```
apps/customer/app/locales/ko/
├── index.ts          # 통합
├── common.ts         # 공통 UI (버튼, 네비게이션, 상태)
├── auth.ts           # 로그인, 회원가입, 비밀번호
├── customer.ts       # 홈, 마이페이지, 프로필
├── sleep-analysis.ts # 수면 분석
├── warranty.ts       # 보증서
├── chat.ts           # AI 상담
├── blog.ts           # 블로그
└── errors.ts         # 에러 메시지
```

---

## 3. 번역 적용 (58개 파일)

### Feature별 적용 현황

| Feature | 파일 수 | 상태 |
|---------|---------|------|
| auth | 13 | 완료 |
| customer (home, mypage) | 9 | 완료 |
| sleep-analysis | 8 | 완료 |
| warranty | 12 | 완료 |
| chat | 10 | 완료 |
| blog | 5 | 완료 |
| 기타 (root, layouts) | 1 | 완료 |

### 적용 패턴
```tsx
// Before
<Button>로그인</Button>

// After
import { useTranslation } from "react-i18next";
const { t } = useTranslation(["auth", "common"]);
<Button>{t("auth:login.submit")}</Button>
```

---

## 4. 버그 수정

### analysis-result.tsx 타입 에러 수정
- **문제**: `riskConfig["낮음"]` - 한글 키가 영문 키 객체에 없어서 타입 에러
- **해결**: `riskConfig.Low` 로 변경 (영문 키 사용)
- **파일**: `apps/customer/app/features/sleep-analysis/components/analysis-result.tsx:426`

---

## 5. 대시보드 국가별 기능 관리 UI (Phase 5)

### 구현 파일
- `apps/dashboard/app/features/settings/screens/i18n-settings.tsx` - 설정 화면
- `apps/dashboard/app/features/settings/lib/i18n.server.ts` - 서버 함수
- `apps/dashboard/app/features/users/components/dashboard-sidebar.tsx` - 사이드바 메뉴 추가
- `apps/dashboard/app/routes.ts` - 라우트 추가

### 기능
1. **지원 언어 탭**: 언어별 활성화/비활성화 토글
2. **국가 탭**: 국가별 활성화/비활성화 토글
3. **국가별 기능 탭**: 국가×기능 매트릭스로 기능 플래그 관리

### 접근 경로
`/dashboard/settings/i18n`

---

## 6. 검수 및 빌드 확인 (Phase 6)

### 빌드 결과
| 앱 | 결과 |
|----|------|
| customer | 빌드 성공 |
| dashboard | 빌드 성공 |

---

## 7. 남은 작업 (향후)

| 내용 | 상태 |
|------|------|
| 다른 언어 번역 파일 추가 (en, ja, vi 등) | 대기 |
| 실제 번역 작업 | 대기 |
| 언어 선택 UI 추가 | 대기 |

---

## 기술 스택

- **i18next** + **react-i18next**: 다국어 라이브러리
- **RTL 지원**: 아랍어 등 우측에서 좌측 언어 지원
- **네임스페이스 분리**: Feature별 번역 파일 관리
- **타입 안전성**: TranslationKeys 타입 정의
